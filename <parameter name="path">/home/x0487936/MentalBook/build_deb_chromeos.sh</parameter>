<parameter name="content">#!/bin/bash
set -e

BUILD_DIR="/tmp/VirtualXander-deb-build"
rm -rf "$BUILD_DIR"
mkdir -p "$BUILD_DIR/DEBIAN"
mkdir -p "$BUILD_DIR/usr/share/VirtualXander"
mkdir -p "$BUILD_DIR/usr/bin"
mkdir -p "$BUILD_DIR/usr/share/applications"

cp MentalBook.jar "$BUILD_DIR/usr/share/VirtualXander/"

cat > "$BUILD_DIR/DEBIAN/control" << 'EOF'
Package: VirtualXander
Version: 0.2.0.0
Section: utils
Priority: optional
Architecture: amd64
Depends: openjdk-17-jre | java17-runtime
Maintainer: Xander Thompson
Description: VirtualXander - Your Companion App
 A friendly virtual companion application powered by Xander's personal feelings and reactions.
 It provides mental health support, conversation, and various helpful features.
EOF

cat > "$BUILD_DIR/usr/bin/VirtualXander" << 'EOF'
#!/bin/bash
APP_DIR="/usr/share/VirtualXander"
java -jar "$APP_DIR/MentalBook.jar" "$@"
EOF
chmod +x "$BUILD_DIR/usr/bin/VirtualXander"

# Create .desktop file for ChromeOS launcher
cat > "$BUILD_DIR/usr/share/applications/VirtualXander.desktop" << 'EOF'
[Desktop Entry]
Type=Application
Name=VirtualXander
Comment=Your Companion App - Mental Health Support
Exec=/usr/bin/VirtualXander
Icon=/usr/share/VirtualXander/icon.png
Terminal=false
Categories=Utility;Education;
StartupNotify=true
EOF

# Create postinst script to update desktop database
cat > "$BUILD_DIR/DEBIAN/postinst" << 'EOF'
#!/bin/bash
update-desktop-database /usr/share/applications
exit 0
EOF
chmod 755 "$BUILD_DIR/DEBIAN/postinst"

dpkg-deb --build "$BUILD_DIR" dist/VirtualXander_0.2.0.0_amd64.deb

echo "Built successfully"
ls -la dist/VirtualXander_0.2.0.0_amd64.deb
</parameter>
